import{b as l,c as o,r as p,h as d,s as r}from"./main-DRDdlS_a.js";let n=null;const i=15*1e3;l(function(){JSON.parse(document.getElementById("updater-state").textContent).IsUpdating&&(console.log("Updating"),n=setInterval(c,i))});function c(){const a=document.getElementById("update-button"),s=document.getElementById("update-status"),u=document.getElementById("last-updated");o("/update/status",{method:"GET"}).then(t=>(t.redirected&&p(t.redirect),t.json().then(e=>({ok:t.ok,data:e})))).then(({ok:t,data:e})=>{if(d(),!t)throw new Error(e.error||"Error occurred");e.yet_to_update!==void 0&&e.yet_to_update?a.disabled=!1:e.status!==void 0?e.status==0?(a.disabled=!0,s.innerHTML="Update Status: <span class='ms-2 px-2 badge bg-warning'>Updating...</span>"):e.status==1?(a.disabled=!1,s.innerHTML="Update Status: <span class='ms-2 px-2 badge bg-success'>Updated</span>",u.innerHTML="Last Updated: <span class='ms-2'>"+e.last_updated_time+"</span>",clearInterval(n)):e.status==2&&(a.disabled=!1,s.innerHTML="Update Status: <span class='ms-2 px-2 badge bg-danger'>Update Failed</span>",clearInterval(n)):(a.disabled=!1,r("Unable to check the update status"),clearInterval(n))}).catch(t=>{a.disabled=!1,d(),r(t.message)})}l(function(){const a=document.getElementById("update-button"),s=document.getElementById("update-status");a.addEventListener("click",function(u){u.preventDefault(),a.disabled=!0,o("/update/start",{method:"POST"}).then(t=>t.json().then(e=>({ok:t.ok,data:e}))).then(({ok:t,data:e})=>{if(d(),!t)throw new Error(e.error||"Error occurred");e.success?(s.innerHTML="Update Status: <span class='ms-2 px-2 badge bg-warning'>Updating...</span>",n=setInterval(c,i)):(a.disabled=!1,a.innerHTML="Update",r(e.error))}).catch(t=>{d(),r(t.message),a.disabled=!1})})});
